<!DOCTYPE html>
<html>
<head>
  <title>Django AJAX Example</title>
</head>
<body>
  <h1>Live Data Table (AJAX + fetch)</h1>
  <table id="data-table" border="1"></table>

  <script>
    async function fetchData() {
      const response = await fetch("/data/");
      const data = await response.json();
      const table = document.getElementById("data-table");

      table.innerHTML = "";

      if (data.length === 0) return;

      const headerRow = table.insertRow();
      Object.keys(data[0]).forEach(key => {
        const th = document.createElement("th");
        th.textContent = key;
        headerRow.appendChild(th);
      });

      data.forEach(row => {
        const tr = table.insertRow();
        Object.values(row).forEach(value => {
          const td = tr.insertCell();
          td.textContent = value;
        });
      });
    }

    fetchData(); // load on page load
    setInterval(fetchData, 60000); // refresh every 60 seconds
  </script>
</body>
</html>
